19 june 2011 computer hacker breached security mt gox worlds largest bitcoin btc exchange time suspicious trading activity followed soon breach triggering flash crash bitcoins price 17 usd 001 usd exchange attacker withdrew small amount approximately 200 btc also leaked exchanges user database consisting usernames hashed passwords mt gox eventually collapsed around 7 february 2014 weight processing delays errors security incidents possible insider fraud although bitcoin system community embrace cryptography decentralization theory practice extensive ecosystem thirdparty intermediaries contribute cryptocurrency economy service providers include currency exchanges escrow services digital wallets mining pools market data suppliers investment funds prices cryptocurrencies usage surged intermediaries become targets cybercriminals major source risk naive individual corporate actors essay focus rise fall mt gox explain matters arose 2011 2014 hacks outline risks cryptocurrency exchanges general
jed mccaleb american software developer started mtgoxcom web site 2007 original purpose trading playing cards popular fantasy game magic gathering fact mt gox stands magic gathering online exchange mccaleb bitten bitcoin bug 2010 july sites order matching system playing cards morphed bitcoin exchange buyers sellers could trade digital currency well manage balances deposits withdrawals early 2011 site become successful aggregate daily transactions exceeding tens thousands dollars took mccalebs time already hacker target needing help fast sold site march mark karpeles french software developer nothing upfront sharing 50 profits first six months sale retaining 12 ownership stake firm exceptionally favorable terms karpeles red flag well assumption existing debts 8000 missing btc extraordinary statements purchase agreement seller uncertain mtgoxcom compliant applicable us code state law country buyer agrees indemnify seller legal action taken buyer seller regards mtgoxcom anything acquired agreement
months karpeles took troubles began earnest 13 june 2011 mt gox reported 478 accounts robbed 2500 btc worth 40000 usd time friday june 17 message offering mt gox user database sale published pastebin plaintext content hosting service used software code review internet relay chat irc members hackers signed tied pastebin message troubling company ignored warning nothing saturday june 18 karpeles reported additional cases theft sunday june 19 36 utc suspicious trading activity suddenly started mt gox someone placed one orders sell hundreds thousands btc exchange rate crashed 17 usd 001 usd largest trade observed btc executed 001 usd 16 exchanges order book constituted 4 65 million btc circulation time later around utc news started travel mt gox site btc exchanges experienced intense volatility exchange rate swinging wildly 1 20 time karpeles woken investigated matter determined attacker compromised mccalebs old administrative account used auditing shut mt gox site later day around utc someone published complete list mt gox usernames email addresses password hashes internet forum list contained accounts equivalent usd account passwords hashed unix crypt utility hundreds passwords plain md5 hashes unsalted could easily later several btc exchanges also began voluntary shutdowns security precaution since many users used multiple exchanges trading utc mt gox began disclosing attack users recommending users used password mt gox electronic services eg email banking etc change warning users possible email phishing attacks promising reverse refund fraudulent trades utc mt gox also confirmed 200 btc stolen valued usd time june 21 mt gox allowed users submit requests recover accounts using account name email address old password new password verification email address optionally providing evidence last known mt gox balance copy government id etc claim requests verified manually mt gox staff june 23 karpeles executed large transfer btc cold storage exchange block confidence building measure prove bitcoins still mt goxs control june 26 mt gox reopened trading one week shut fraudulent trades indeed rolled back companys expense introduced salted hashes passwords well user verification upon firsttime login using last ip address accessed account verifying email address account name old password users prompted enter new strong password exchange rate stabilized around usd within hours neither selloffs mass withdrawals well right
bitcoins price continued climb mt gox grew handle 70 btc transactions 2013 karpeles became major figure bitcoin world holding interviews major news organizations endowing bitcoin foundation board member since resigned expanding company headquarters tokyos shibuya neighborhood beneath surface success company serious business technology problems first according former employees interviewed mt gox use software version control system meant one engineer could accidentally modify colleagues code neither history changes reliable mechanism merging reverting known working copy second karpeles one could approve changes sites source code meant bug fixes ª even security related items ª could delayed days sometimes weeks third introduced test environment quality assurance spring 2013 years karpeles taken company already primary bitcoin hub fourth mt gox accounting system process reconciling offline btc balance inventory online btc balance liquidity cash balance currency exchange need accuracy transparency complicated karpeles paranoid insistence keeping bitcoins offline cold storage would secure hackers fifth mt gox sued coinlab may 2 allegedly violating contract signed february transfer north american customers coinlabs never actually occurred sixth company somehow registered license us government money transmitter may 15 us department homeland security issued warrant seize money mt goxs subsidiary account payment processor dwolla may july dhs agents seized 5m usd subsidiary june 29 mt gox finally received money services business msb license us financial crimes enforcement network fincen summary bank financial services company insisting highest ethical professional standards would operate manner post911 crisis world
august 5 2013 mt gox announced incurred significant losses due crediting deposits fully cleared new deposits would longer credited funds transfer fully completed november customers experiencing delays weeks months withdrawing cash accounts mt gox also lost place top exchange dropping third 7 february 2014 mt gox stopped btc withdrawals explained obtain clear technical view currency processes february 10 mt gox divulged root cause may transaction malleability possible double spending working bitcoin core development team mitigate problem coindesk poll 300 mt gox customers time suggested 68 polled customers still awaiting funds mt gox median waiting time one three months february 20 protests outside mt gox office continued citing security concerns company moved offices different location tokyo february 24 mt gox suspended trading website went offline six major bitcoin exchanges issued joint statement distancing mt gox february 28 mt gox filed tokyo form bankruptcy protection creditors declaring liabilities 65 billion yen 65 million usd 38 billion yen assets company also said lost 744408 btc belonging customers around 10000 totaling around 7 12 million btc circulation worth around 470 million usd time mt gox issued another statement saying believed bitcoins likely stolen blamed hackers began search missing bitcoins two weeks later mt gox filed bankruptcy usa march 20 mt gox reported discovered 20000 btc old digital wallet used prior june 2011 karpeles finally arrested august 2015 japanese police charged fraud embezzlement stealing money personal use remained jail 2016 granted bail case closed right yet july 2017 russian national named alexander vinnik arrested us authorities greece charged playing key role laundering bitcoins stolen mt gox furthermore vinnik charged greek authorities laundering approximately 4 billion bitcoin us fbi also raided btce rival exchange vinnik alleged associated part investigation
multitude lessons learned case study useful professionals well individual corporate actors interested cryptocurrencies
people leadership values organization foundation important success factors mccaleb karpeles may possessed individual engineering talents entrepreneurial instincts knew little running highperformance software development team let alone sophisticated financial services organization
security flaws mt gox bitcoins design companys accounting system naive approach database network user security mt gox managed violate nearly every important computer security principle refer interested reader excellent book building secure software gary mcgraw john first mt gox secure weakest link granted many privileges get work done system security june 2011 hack made possible mccalebs old administrative account kept active facilitate ability audit verify exchange commissions conflicting reports whether sql injection crosssite forgery attack root cause accounts compromise case vulnerabilities wellknown sites software audited engineering group independent development team moreover account many privileges across mt gox used login remotely dump user database consequently allowed attacker perform flash crash attempt circumvent daily withdrawal limit 100 remote login account readonly provisioned without authority extract user database would prevented ensuing damage second mt goxs system defenses shallow user database copied attacker decrypt unsalted md5 hashed passwords generate sufficient trading volume crash exchange rate md5 hash function producing value designed ronald rivest 1991 security flaws found researchers make vulnerable collisions brute force attacks extension length attacks community consensus industry government 2010 md5 insecure useful checksums message digests mt gox using first published 2001 nsa mainstream 2011 already implemented ssl pgp ssh ipsec furthermore user login used twofactor authentication password well onetime pin sent email text third forgot hiding secrets hard subsequent investigations 2014 hack nilsson wizsec decker university eth zurich bitcoin security researchers suggests lost bitcoins due theft mt goxs hot wallet private keys september 2011 transaction malleability alleged mt gox unencrypted walletdat file gave attacker access large number btc owned company importantly private keys asymmetric cryptography core building block bitcoins design private keys allow users spend authorized transactions generating unique signatures mathematically possible key owner effect private keys hands skillful patient attacker could used slowly transfer btc secure addresses without proper reconciliation case mt gox could interpreted part normal business processes moving btc cold storage wizsec identified vinnik owner wallets many stolen bitcoins transferred key management becomes incredibly important bitcoin system mt gox could prevented theft hot wallet following several best practices minimize size number keys hot wallet move rest cold storage savings backup entire hot wallet encrypt online backup use many secure locations make regular backups
complexity design matters whether reasoning bitcoin security financial accounting systems one cannot reasonably expect twentysomething amateurs design secure accounting trading system based original commodity playing cards nerds part story would absurdly funny hypothetical sadly true
communications matter customers especially crisis mt gox notified customers within hours 2011 hack took weeks 2014 incident bottom line breached prompt clear transparent response skip excuses blaming others waste time
quality devops fundamental principles practices highperformance software development organizations mt gox used version control setup separate test environments production used dedicated qa team institutionalized change control committeebased review rather process personality conducted penetration tests security profile
risks abound individual corporate actors interested digital cryptocurrencies especially using exchanges operate defacto centralized authority ª remarkable irony many ignore peril research bitcoin exchange security moore christin shows 80 exchanges operational period nearly half 38 closed 26 experienced security breaches besides closure security risks others related legal regulatory action governments mention market volatility transactions
